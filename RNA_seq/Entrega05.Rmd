---
title: "Reporte_05"
author: "Jessica Garcia, Manuel Rivera, Axel Rodriguez"
date: "2023-03-03"
output:
  html_document:
    toc: true # table of content true
    toc_float: yes
    toc_depth: 3  # upto three depths of headings (specified by #, ## and ###)
    number_sections: true  ## if you want number sections at each table header
    theme: united  # many options for theme, this one is my favorite.
    highlight: tango  # specifies the syntax highlighting style
  pdf_document: 
    toc: true
    toc_depth: 3
    number_sections: true
    pandoc_args: --listings # Para que no se salga el codigo del margen
    includes:
      in_header: preamble.tex
---


# Informacion de los datos

- Nombre del proyecto: PRJNA826506

- Link: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE200762

- Especie: Homo_Sapiens

- Descargar los archivos de Bioproject
```bash 
# Nombres de los SRA
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/human_fastq.txt

# Instrucciones para descarga y cambio a Fastq
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/SRAData_dow.sh

# Donde se descargan los archivos
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/data

# Ruta del JOB
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/SRA_run.sge
```

- Para el analisis de calidad de la 'rawdata' se creo el job "Trimmed_run.sge"
```bash
# Ubicacion del JOB
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens

# Descargar analisis FastQC --> computadora
rsync -rptuvl mrivera@dna.lavis.unam.mx:/mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/FastQC_rawData ./Documents
```

## Limpieza de adaptadores

- Limpieza de adaptadores con el JOB 'Trimmed_run.sge'
```bash

# Ubicacion de adaptadores para paired-end
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/TruSeq3-PE.fa

# Ubicacion de los datos sin adaptadores
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/data_trimmed

# Analisis MultiQC de datos sin adaptadores
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/FastQC_trimmed/multiqc_report.html

# Descargar MultiQC de datos sin adaptadores a mi computadora
rsync -rptuvl mrivera@dna.lavis.unam.mx:/mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/FastQC_trimmed ./Documents
```
--------------------------------------------------------------------------------

# Analisis MultiQC rawdata

- Todas son de 150 bp.

- El SRA que tiene mas secuenciaciones es 'SRR18745762' con $66.1 \space Millones$. El SRA con menos secuencias fue 'SRR18745771' con $3 \space Millones$.

- El SRA 'SRR18745762' tiene $75.6 \% $ de duplicados. Si bien esto podría suponer un problema, debemos recordar que trabajamos con RNA-seq y los duplicados se puede deber a la expresion de un pequeño numero de genes. En RRna-seq no deben de eliminarse los duplicados, a menos que tengan UMIs(barcodes).

- Esta grafica nos muestra que todos los archivos tuvieron una buena calidad. Siendo la muestra 'SRR18745771_1' la que tiene la calidad mas baja de $24.53$, es decir, el error esta entre $0.01<error<.001$

- https://dnatech.genomecenter.ucdavis.edu/faqs/should-i-remove-pcr-duplicates-from-my-rna-seq-data/
- https://www.biostars.org/p/14283/ 

## Per Sequence GC Content 

- Solamente 2 muestras salieron bien, el resto tuvieron alertas (11) o fueron marcadas como errores (9). Esto es normal, ya que las primeras 10-12 bases son resultado del hexamero utilizado como primers, este hexamero esta compuesto de forma aleatoria.

- https://hbctraining.github.io/Intro-to-rnaseq-hpc-salmon/lessons/qc_fastqc_assessment.html#:~:text=The%20%E2%80%9CPer%20sequence%20GC%20content,expected%20%25%20GC%20for%20the%20organism.

## Per Base N Content 

- Todas las muestras pasaron la prueba, esto indica que todas las posiciones tienen asignadas una base.

- https://rtsf.natsci.msu.edu/sites/_rtsf/assets/File/FastQC_TutorialAndFAQ_080717.pdf

## Overrepresented sequence

- Es posible que la sobrerepresentacion de las secuencias se deban a que un transcriptoma es muy abundante.

- https://rtsf.natsci.msu.edu/genomics/tech-notes/fastqc-tutorial-and-faq/#:~:text=Overrepresented%20Sequences,to%20try%20to%20identify%20it.

## Adapter Content 

- Solamente 2 muestras tienen alerta 'SRR18745771_1 y SRR18745768_1' esto ocurre debido a que el adaptador esta presente en mas del $5 \% $ de las lecturas. El resto de las muestras tienen errores, esto indica que el adaptador esta presente en mas del $10 \% $ de las lecturas.

- https://www.ridom.de/seqsphere/u/FASTQ_Quality_Control_(FastQC).html

--------------------------------------------------------------------------------
# Analisis MultiQC sin adaptadores







--------------------------------------------------------------------------------
# Kallisto pseudo alligment

- Descargar transcriptoma de referencia
```bash
# Generar transcriptoma de referencia meaidnte el JOB 'Transcript_down.sge', con las instrucciones:
wget https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_43/gencode.v43.transcripts.fa.gz 

# Ubicacion transciptoma de referencia
cd /mnt/Timina/bioinfoII/rnaseq/BioProject_2023/rawData/Homo_sapiens/gencode.v43.transcripts.fa.gz

# Carpeta de archivos kallisto
mkdir kallisto_quant_test
```

- Generar un JOB 'Kallisto_down_data.sge'.
```bash
#!/bin/bash
#
# Use Current working directory
#$ -cwd
#
# Join stdout and stderr
#$ -j n
#
# Run job through bash shell
#$ -S /bin/bash
#
# You can edit the script since this line
#
# Your job name
#$ -N Kallisto_down_data
#
# Send an email after the job has finished
#$ -m e
#$ -M rivera20c3@gmail.com
#
#
# If modules are needed, source modules environment (Do not delete the next line):
. /etc/profile.d/modules.sh
#
# Add any modules you might require:
module load kallisto/0.45.0
#
# Write your commands in the next line

# Generar index de kallisto
kallisto index ./gencode.v43.transcripts.fa.gz -i ./kallisto_quant_test/HS_ref.kidx 

# - i nombre del archivo de salida, i.e., indice
#- Input =  gencode.v43.transcripts.fa.gz, transcriptoma de referencia

 # Paired-end  
for file in ./data_trimmed/*_1_trimmed.fastq.gz                                                 # Read1
do
  clean=$(echo $file | sed 's/_trimmed//;s/\.fastq\.gz//;s/_1//')         # Nombre de la carpeta de salida, mismo nombre de SRA
  file_2=$(echo ${clean}_2_trimmed.fastq.gz| sed 's/FP/RP/')                                            # Read2
  kallisto quant --index ./kallisto_quant_test/HS_ref.kidx --output-dir ./kallisto_quant_test/${clean} --threads 12 ${file} ${file_2}
done
```


- Mostrar resultados del alineamiento
```bash

# JOB 'Kallisto_down_data.sge' para generar el alineamiento
cd ./Kallisto_down_data.sge

# Se encuentran en el archivo de errores del JOB
cat Kallisto_down_data.e276381 
```
--------------------------------------------------------------------------------
# Caractersticas de las muestras

- Tipo de bibliotecas

- Método de selección (ej: poly A)

- Número de transcriptomas

- Número de réplicas biológicas

- Secuenciador

- Distribución de las muestras (control y tratamiento)

- Profundidad de secuenciación de cada transcriptoma

--------------------------------------------------------------------------------

# Abstract o resumen de mi trabajo

¿Qué comparamos?

¿Qué tipo de datos analizaste?

¿Qué programas usaste y por qué?

Información breve de que obtuviste

Máximo 200 palabras

--------------------------------------------------------------------------------

# Buenas practicas de bioinformatica




--------------------------------------------------------------------------------

# Resultados y discusión




--------------------------------------------------------------------------------
# DESEQ2 
# Jessica 'Volcano plot'
# Axel 'Heatmap'


--------------------------------------------------------------------------------
# Graficas GO (Manuel)



